This is my writeup for Section 7 of the [CC: pentesting room](https://tryhackme.com/room/ccpentesting) on TryHackMe. This is a super simple box, and I am writing this more so to practice writing and taking notes in markdown.

## Start off with our nmap scan
```bash
sudo nmap -sC -sV -oN initial 10.10.244.20 && sudo nmap -p- -T5 -oN all-ports 10.10.244.20
```

We see only two ports open: 80 and 22. The all ports scan returned nothing.

![[nmap scan.png]]

## Web directory enumeration

Upon seeing the apache web server, I immediately fired up gobuster.

```bash
gobuster dir -u http://10.10.244.20/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -o gobuster.out
```

While the gobuster was running, I browsed to the site and got the default apache "it works!" page. Browsing the source of site reveals nothing as well. Oh well, time to go see if gobuster found anything.

gobuster output:
![[initial gobuster.png]]

/server-status is 403 (forbidden), so it's of no use to us. We found a /secret directory, but I saw nothing in it and checking page source reveals nothing.

**I should have run gobuster with the extensions option at this point, we know this is an apache web server, so I should have run a scan with extensions of php, html, and txt**

I tried to find an exploit for the specific apache version and ssh version shown in the nmap results above, but got nothing concrete. I also ran nikto, but as usual, nikto output confuses me more than helps. I had to consult the hint unfortunately, and slapped myself when I saw that it reminded me to run a gobuster with extensions. *note to self: do not be impatient with your scans and do them properly as well as thoroughly*

Running a gobuster with the extensions specified above within the discovered /secret directory:
```bash
gobuster dir -u http://10.10.244.20/secret/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x txt,html,php -o gobuster-ext.out
```

We find secrets.txt within the /secret directory and it has the following txt file:

```nyan:046385855FC9580393853D8E81F240B66FE9A7B8```

## Initial access

These look like creds, but that password looks a little strange... Either way, I tried to ssh into the box with the creds provided. Unsurprisingly, they did not work, so I browsed to crackstation to see if it could unencrypt the password for me. After failing the captcha no less than three times, we get:

![[crackstation.png]]

I ssh into the box with these creds and a quick ```ls``` shows us our first flag!

![[ssh.png]]

## Privilege escalation

The first thing I want to do is see if there are any other users. However, browsing to both the /home directory and the /etc/passwd file shows us we are the only created user. 

My next step was to see if there were any commands we could run as sudo. *note: sudo -l will print out the commands allowed (and forbidden) by the current user*

![[sudo-l.png]]

Well, alrighty then, that seemed easier than I thought it would be. 'su' means switch user and being able to run the su command as root (with sudo) means we can switch to any user, including root. A quick ```sudo su -``` makes us the root user.

![[priv-esc.png]]

We find the second (and last) flag in root's home directory:

![[final flag.png]]

Section complete!